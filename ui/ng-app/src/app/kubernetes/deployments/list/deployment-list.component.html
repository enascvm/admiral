<!--
  ~ Copyright (c) 2017-2018 VMware, Inc. All Rights Reserved.
  ~
  ~ This product is licensed to you under the Apache License, Version 2.0 (the "License").
  ~ You may not use this product except in compliance with the License.
  ~
  ~ This product may include a number of subcomponents with separate copyright notices
  ~ and license terms. Your use of these subcomponents is subject to the terms and
  ~ conditions of the subcomponent's license, as noted in the LICENSE file.
  -->

<grid-view #gridView [serviceEndpoint]="serviceEndpoint"
           [searchPlaceholder]="'kubernetes.deployments.search.placeholder' | i18n"
           [searchSuggestionProperties]="['name']">

    <div title>{{"kubernetes.deployments.title" | i18n | titlecase}}</div>

    <ng-template let-item="item">
        <card [routerLink]="['./' + item.documentId]" [ngClass]="{'card-actions-selected': isItemSelected(item)}">
            <div card-header>
                <img [src]="'/container-image-icons?container-image=' + item.documentSelfLink"/>

                <div class="titleHolder">
                    <div class="truncate">{{ item.name }}</div>
                </div>

                <clr-dropdown class="card-actions" (click)="toggleItemSelection($event, item)">
                    <button type="button" class="btn btn-sm btn-link" clrDropdownTrigger>
                        <clr-icon shape="ellipsis-vertical" size="20"></clr-icon>
                    </button>
                    <clr-dropdown-menu clrPosition="left-top" *clrIfOpen>
                        <button type="button" class="dropdown-item cluster-details"
                                [routerLink]="['./' + item.documentId]">
                            <clr-icon shape="eye" size="20" class="card-drop-down-actions">
                            </clr-icon>{{"details" | i18n}}
                        </button>
                    </clr-dropdown-menu>
                </clr-dropdown>
            </div>

            <div card-content>
                <div card-content>
                    <div class="form-group">
                        <label>{{"kubernetes.deployments.item.creation" | i18n}}</label>
                        <div>{{item.deployment?.metadata.creationTimestamp | date:'yyyy-MM-dd HH:mm:ss' || "--"}}</div>
                    </div>
                    <div class="form-group">
                        <label>{{"kubernetes.deployments.item.namespace" | i18n}}</label>
                        <div>{{item.deployment?.metadata.namespace || "--"}}</div>
                    </div>
                    <div class="form-group">
                        <label>{{"kubernetes.deployments.item.containersNumber" | i18n}}</label>
                        <div>{{item.deployment?.spec.template.spec.containers.length || "--"}}</div>
                    </div>
                    <div class="form-group">
                        <label>{{"kubernetes.deployments.item.restartPolicy" | i18n}}</label>
                        <div>{{item.deployment?.spec.template.spec.restartPolicy || "--"}}</div>
                    </div>
                    <div class="form-group">
                        <label>{{"kubernetes.deployments.item.strategy" | i18n}}</label>
                        <div>{{item.deployment?.spec.strategy.type || "--"}}</div>
                    </div>
                </div>
            </div>
        </card>
    </ng-template>
</grid-view>
